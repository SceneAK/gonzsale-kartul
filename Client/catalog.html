<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Item Catalog</title>
    <style>
        /* Body and general styles */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }

        .catalog {
            padding: 20px;
        }

        /* Tab links */
        .tablink {
            background-color: #f9f9f9;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 16px;
        }

        .tablink:hover {
            background-color: #ddd;
        }

        /* Tab content */
        .tabcontent {
            display: none;
            padding: 20px;
            background-color: #fff;
        }

        .item {
            display: inline-block;
            margin: 10px;
            text-align: center;
        }

        .item img {
            width: 150px;
            height: 150px;
        }

        .item p {
            font-size: 16px;
        }

        /* Active class for the selected tablink */
        .active {
            background-color: #ff9900;
            color: white;
        }
    </style>
</head>

<body>
    <!-- Header section -->
    <div id="header"></div>

    <!-- Main content -->
    <div class="catalog">
        <h1>Item Catalog</h1>

        <!-- Category Contents -->
        <div id="Shirts" class="tabcontent">
            <div id="shirt-items-container"></div>
        </div>

        <div id="Pants" class="tabcontent">
            <div id="pant-items-container"></div>
        </div>

        <div id="Accessories" class="tabcontent">
            <div id="accessory-items-container"></div>
        </div>

        <div id="Food" class="tabcontent">
            <div id="food-items-container"></div>
        </div>

        <div id="Drinks" class="tabcontent">
            <div id="drink-item-container"></div>
        </div>

        <div id="All" class="tabcontent">
            <div id="all-items-container"></div>
        </div>
    </div>

    <!-- Footer section -->
    <div id="footer"></div>

    <script>
        // Handle switching between tabs
        function openCategory(evt, categoryName) {
            const tabcontents = document.getElementsByClassName("tabcontent");
            const tablinks = document.getElementsByClassName("tablink");

            // Hide all tab contents
            for (const tab of tabcontents) {
                tab.style.display = "none";
            }

            // Remove active class from all tab links
            for (const link of tablinks) {
                link.classList.remove("active");
            }

            // Show the selected category's content
            document.getElementById(categoryName).style.display = "block";
            if (evt) evt.currentTarget.classList.add("active");
        }

        // Function to fetch items from API
        async function fetchItems(category, containerId) {
            try {
                const url = `${window.location.protocol}://${window.location.host}`;
                //console.log(url);
                const response = await fetch(`http://localhost:3000/${category}`);
                if (!response.ok) throw new Error(`Failed to fetch ${category} items`);

                const items = await response.json();
                const container = document.getElementById(containerId);

                // Clear container and populate items
                container.innerHTML = '';
                items.forEach(item => {
                    const itemDiv = document.createElement("div");
                    itemDiv.classList.add("item");
                    

                    itemDiv.innerHTML = `
                        <img src="${item.product_imgUrl}" alt="${item.product_name}" />
                        <p>${item.product_name} - ${item.product_price} ${item.product_unit}</p>
                    `;
                    container.appendChild(itemDiv);
                });
                console.log(container.innerHTML);
            } catch (error) {
                console.error(`Error fetching ${category} items:`, error);
                document.getElementById(containerId).innerHTML = `<p>Failed to load ${category} items. Please try again later.</p>`;
            }
        }

        // Automatically load content for all categories
        document.addEventListener("DOMContentLoaded", function () {
            const categories = {
                Shirts: "shirt-items-container",
                Pants: "pant-items-container",
                Accessories: "accessory-items-container",
                Food: "food-items-container",
                Stickers: "drink-item-container",
                All: "all-items-container",
            };

            // Fetch items for each category
            for (const [category, containerId] of Object.entries(categories)) {
                fetchItems(category.toLowerCase(), containerId);
            }

            // Default open Shirts tab
            openCategory(null, "Shirts");
        });

        // Load external header and footer
        function loadHTML(file, elementId) {
            fetch(file)
                .then(response => response.text())
                .then(data => {
                    document.getElementById(elementId).innerHTML = data;
                });
        }

        loadHTML("header.html", "header");
        loadHTML("footer.html", "footer");
    </script>
</body>

</html>